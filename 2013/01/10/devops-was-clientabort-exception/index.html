<!DOCTYPE html><html lang="ko" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Tomcat에서 발생하는 ClientAbortException · 안녕 프로그래밍</title><meta name="description" content="운영환경에서 발생하는 다양한 이슈들"><meta name="og:title" content="Tomcat에서 발생하는 ClientAbortException"><meta name="og:type" content="website"><meta name="og:url" content="https://www.holaxprogramming.com/2013/01/10/devops-was-clientabort-exception/"><meta name="og:image" content="http://image.toast.com/aaaaahq/hola_cover.JPG"><meta name="og:description" content="운영환경에서 발생하는 다양한 이슈들"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/chiangmai.css"><meta name="steem:author" content="@stunstunstun"><meta name="fb:app_id" content="1258629384258634"><link rel="search" type="application/opensearchdescription+xml" href="https://www.holaxprogramming.com/atom.xml" title="안녕 프로그래밍"></head><body class="post"><div id="fb-root"></div><div class="wrap"><header><nav class="navi-post"><a class="navi-post-back" href="javascript:history.back()"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="navi-post-home" href="/"><i class="fa fa-home" aria-hidden="true"></i></a></nav></header><main class="post"><div class="post"><article class="post-block"><h1 class="post-title">Tomcat에서 발생하는 ClientAbortException</h1><div class="post-info"><div class="post-info-profile"><a href="https://github.com/stunstunstun" target="_blank"><img src="/image/profile.jpg"></a></div><div class="post-info-details"><div class="post-categories"><a href="/categories/devops" target="_self"><span>DEVOPS</span></a></div><div class="post-date">2013년 1월 10일</div></div></div><div class="post-share"><div class="fb-like" data-href="https://www.holaxprogramming.com/2013/01/10/devops-was-clientabort-exception/" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="false">                 </div><div class="fb-share-button" data-href="https://www.holaxprogramming.com/2013/01/10/devops-was-clientabort-exception/" data-layout="button" data-size="small" data-mobile-iframe="true"></div><div class="fb-follow" data-href="https://www.facebook.com/holaxprogramming/" data-layout="button_count" data-size="small" data-show-faces="true"></div></div><div class="post-content"><p>사내에서 운영중인 웹서비스의 로그에서 아래와 같은 Exception이 다량으로 발견되는 것을 확인하였다. 혹시 서비스에 중요한 영향을 미치지 않을까하는 걱정이 앞서 예외가 발생하는 원인을 살펴보았다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java.lang.Object</span><br><span class="line">  ㄴ java.lang.Throwable</span><br><span class="line">      ㄴ java.lang.Exception</span><br><span class="line">          ㄴ java.io.IOException</span><br><span class="line">             ㄴ org.apache.catalina.connector.ClientAbortException</span><br></pre></td></tr></table></figure>
<h4 id="org-apache-catalina-connector-ClientAbortException"><a href="#org-apache-catalina-connector-ClientAbortException" class="headerlink" title="org.apache.catalina.connector.ClientAbortException"></a>org.apache.catalina.connector.ClientAbortException</h4><p>ClientAbortException은 애플리케이션에서 발생하는 것이 아닌, Tomcat 컨테이너에서 특정 상황에서 발생하는 예외였는데 특이한 부분은 HTTP Request의 Header를 살펴보니 Agent값을 통해 모바일 환경의 클라이언트 요청에서 많이 발생되고 있었다. 아래는 abort는 라는 단어의 뜻인데,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abort 미국식 [ə|bɔ:rt] 발음듣기 영국식 [ə|bɔ:t] 발음듣기 예문보기</span><br><span class="line">1. 유산시키다   2. 유산하다   3. (일을) 도중하차하다</span><br></pre></td></tr></table></figure>
<p>단어의 의미에서 예외가 발생하는 원인을 유추해볼 수 있었는데, 클라이언트에서 서버로 요청을 한 뒤 응답을 받기전에 요청이 중단되었을 경우 발생 되는 예외라는 것을 확인 할 수 있었다.</p>
<p>실제로 재현해보는 과정이 필요해 보았고 <code>ClientAbortException</code>을 발생시키기 위한 재현 시나리오는 아래와 같다.</p>
<p><code>시나리오 A</code></p>
<ul>
<li>클라이언트에서 서버에 HTTP 요청이 된다</li>
<li>HTTP 응답을 받기 전에 동일한 End-point에 대한 HTTP 요청을 한다</li>
</ul>
<p><code>시나리오 B</code></p>
<ul>
<li>클라이언트에서 서버에 파일 업로드와 같은 비교적 긴 HTTP 요청을 한다</li>
<li>웹 브라우져 또는 모바일 클라이언트에서 요청이 진행되는 중에 강제로 HTTP 요청을 중지한다</li>
</ul>
<h4 id="어떻게-해결해야-할까"><a href="#어떻게-해결해야-할까" class="headerlink" title="어떻게 해결해야 할까?"></a>어떻게 해결해야 할까?</h4><p>먼저 ClientAbortException은 서버 애플리케이션에서 발생하는 버그가 아니다. 서버 애플리케이션에서는 ClientAbortException을 로그 범위에서 WARN 레벨로 변경하는 것 정도이며, 클라이언트에서 위와 같은 시나리오가 발생되는 것은 정상적인 케이스가 아니기 때문에 클라이언트에서 HTTP 응답을 받기 전에 동일한 HTTP 요청을 하는 것에 대한 Secure 대책이 필요해 보인다.</p>
<h4 id="References"><a href="#References" class="headerlink" title="References"></a>References</h4><ul>
<li><a href="https://tomcat.apache.org/tomcat-6.0-doc/api/org/apache/catalina/connector/ClientAbortException.html" target="_blank" rel="external">https://tomcat.apache.org/tomcat-6.0-doc/api/org/apache/catalina/connector/ClientAbortException.html</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2013/01/05/blahblah-hello-newbies/"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="next" href="/2013/01/10/devops-how-to-manage-dbcp/"><i class="fa fa-arrow-right" aria-hidden="true"></i></a></div><ins class="adsbygoogle adsense-bottom" style="display:block;" data-ad-client="ca-pub-6188640546219653" data-ad-slot="6129396565" data-ad-format="auto"></ins><div class="fb-comments-area"><div class="fb-comments" data-href="https://www.holaxprogramming.com/2013/01/10/devops-was-clientabort-exception/" data-width="700" data-numposts="5"></div></div><div class="copyright"><p>© 2012 - 2022 <a href="https://github.com/stunstunstun" target="_blank">Minhyeok Jung</a>. Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/stunstunstun/hexo-theme-chiangmai" target="_blank">hexo-theme-chiangmai</a>.</p></div></footer></div><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><script>window.fbAsyncInit=function(){FB.init({appId:"1258629384258634",cookie:!0,xfbml:!0,version:"v2.8"}),FB.AppEvents.logPageView()},function(e,n,t){var o,c=e.getElementsByTagName(n)[0];e.getElementById(t)||((o=e.createElement(n)).id=t,o.src="//connect.facebook.net/en_US/sdk.js",c.parentNode.insertBefore(o,c))}(document,"script","facebook-jssdk");</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create','UA-97419941-1','auto');ga('send','pageview');</script></body></html>